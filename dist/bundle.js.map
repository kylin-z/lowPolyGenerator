{"version":3,"file":"bundle.js","sources":["../src/util.js","../src/index.js"],"sourcesContent":["\nexport const cvtColorToGray = function (data) {\n  for (let i = 0; i < data.length; i += 4) {\n    let grayscale = data[i] * .3 + data[i + 1] * .59 + data[i + 2] * .11\n    data[i] = grayscale; // red\n    data[i + 1] = grayscale; // green\n    data[i + 2] = grayscale; // blue\n    // alpha\n  }\n  return data\n}\n\nexport const gaussianBlur = function (pixes, width, height, radius, sigma) {\n\n  var gaussMatrix = [],\n    gaussSum = 0,\n    x, y,\n    r, g, b, a,\n    i, j, k, len\n\n\n  radius = Math.floor(radius) || 3\n  sigma = sigma || radius / 3\n\n  a = 1 / (Math.sqrt(2 * Math.PI) * sigma)\n  b = -1 / (2 * sigma * sigma)\n  //生成高斯矩阵\n  for (i = 0, x = -radius; x <= radius; x++ , i++) {\n    g = a * Math.exp(b * x * x)\n    gaussMatrix[i] = g\n    gaussSum += g\n\n  }\n  //归一化, 保证高斯矩阵的值在[0,1]之间\n  for (i = 0, len = gaussMatrix.length; i < len; i++) {\n    gaussMatrix[i] /= gaussSum\n  }\n  //x 方向一维高斯运算\n  for (y = 0; y < height; y++) {\n    for (x = 0; x < width; x++) {\n      r = g = b = a = 0\n      gaussSum = 0\n      for (j = -radius; j <= radius; j++) {\n        k = x + j\n        if (k >= 0 && k < width) { //确保 k 没超出 x 的范围\n          //r,g,b,a 四个一组\n          i = (y * width + k) * 4\n          r += pixes[i] * gaussMatrix[j + radius]\n          g += pixes[i + 1] * gaussMatrix[j + radius]\n          b += pixes[i + 2] * gaussMatrix[j + radius]\n          // a += pixes[i + 3] * gaussMatrix[j];\n          gaussSum += gaussMatrix[j + radius]\n        }\n      }\n      i = (y * width + x) * 4\n      // 除以 gaussSum 是为了消除处于边缘的像素, 高斯运算不足的问题\n      // console.log(gaussSum)\n      pixes[i] = r / gaussSum;\n      pixes[i + 1] = g / gaussSum\n      pixes[i + 2] = b / gaussSum\n      // pixes[i + 3] = a ;\n    }\n  }\n  //y 方向一维高斯运算\n  for (x = 0; x < width; x++) {\n    for (y = 0; y < height; y++) {\n      r = g = b = a = 0\n      gaussSum = 0\n      for (j = -radius; j <= radius; j++) {\n        k = y + j\n        if (k >= 0 && k < height) { //确保 k 没超出 y 的范围\n          i = (k * width + x) * 4\n          r += pixes[i] * gaussMatrix[j + radius]\n          g += pixes[i + 1] * gaussMatrix[j + radius]\n          b += pixes[i + 2] * gaussMatrix[j + radius]\n          // a += pixes[i + 3] * gaussMatrix[j];\n          gaussSum += gaussMatrix[j + radius]\n        }\n      }\n      i = (y * width + x) * 4\n      pixes[i] = r / gaussSum\n      pixes[i + 1] = g / gaussSum\n      pixes[i + 2] = b / gaussSum\n      // pixes[i] = r ;\n      // pixes[i + 1] = g ;\n      // pixes[i + 2] = b ;\n      // pixes[i + 3] = a ;\n    }\n  }\n\n  return pixes;\n}\n\nexport const bindPixelAt = function(data, width, height) {\n  return function (x, y, i) {\n    i = i || 0\n    return data[4*(width*x+y)+i]\n    // return data[((width * y) + x) * 4 + i]\n  }\n}\n\nexport const sobel = function (imageData, width, height) {\n\n  var kernelX = [\n    [-1, 0, 1],\n    [-2, 0, 2],\n    [-1, 0, 1]\n  ]\n\n  var kernelY = [\n    [-1, -2, -1],\n    [0, 0, 0],\n    [1, 2, 1]\n  ]\n\n  var sobelData = []\n  var grayscaleData = []\n\n  //梯度方向矩阵\n  var directionMap = []\n\n  var data = imageData\n  var pixelAt = bindPixelAt(data, width, height)\n  var x, y\n\n  for (x = 0; x < width; x++) {\n  \n    var directionHorizontalMap = []\n\n    for (y = 0; y < height; y++) {\n      var pixelX = (\n        (kernelX[0][0] * pixelAt(x - 1, y - 1)) +\n        (kernelX[0][1] * pixelAt(x, y - 1)) +\n        (kernelX[0][2] * pixelAt(x + 1, y - 1)) +\n        (kernelX[1][0] * pixelAt(x - 1, y)) +\n        (kernelX[1][1] * pixelAt(x, y)) +\n        (kernelX[1][2] * pixelAt(x + 1, y)) +\n        (kernelX[2][0] * pixelAt(x - 1, y + 1)) +\n        (kernelX[2][1] * pixelAt(x, y + 1)) +\n        (kernelX[2][2] * pixelAt(x + 1, y + 1))\n      )\n\n      var pixelY = (\n        (kernelY[0][0] * pixelAt(x - 1, y - 1)) +\n        (kernelY[0][1] * pixelAt(x, y - 1)) +\n        (kernelY[0][2] * pixelAt(x + 1, y - 1)) +\n        (kernelY[1][0] * pixelAt(x - 1, y)) +\n        (kernelY[1][1] * pixelAt(x, y)) +\n        (kernelY[1][2] * pixelAt(x + 1, y)) +\n        (kernelY[2][0] * pixelAt(x - 1, y + 1)) +\n        (kernelY[2][1] * pixelAt(x, y + 1)) +\n        (kernelY[2][2] * pixelAt(x + 1, y + 1))\n      )\n\n      // var magnitude = Math.abs(pixelX) + Math.abs(pixelY)\n\n      var magnitude = Math.sqrt((pixelX * pixelX) + (pixelY * pixelY)) >>> 0\n\n      sobelData.push(magnitude, magnitude, magnitude, 255)\n\n      if (Math.abs(pixelX) >= Math.abs(pixelY)) directionHorizontalMap.push(0)\n      else directionHorizontalMap.push(1)\n    }\n    directionMap.push(directionHorizontalMap)\n  }\n\n  var clampedArray = sobelData\n\n  if (typeof Uint8ClampedArray === 'function') {\n    clampedArray = new Uint8ClampedArray(sobelData)\n  }\n\n  return {\n    gradientMap: clampedArray,\n    directionMap: directionMap\n  }\n}\n\n\n\nexport const anchor = function (gradientMap, directionMap, width, height, AnchorThresh) {\n\n  var pixelAt = bindPixelAt(gradientMap, width, height)\n  var AnchorData = []\n\n  var x, y\n\n\n  for (x = 0; x < width; x++) {\n    for (y = 0; y < height; y++) {\n      if (x == 0 || x == width - 1 || y == 0 || y == height - 1)\n        AnchorData.push(0, 0, 0, 255)\n      else {\n        if (directionMap[x][y] == 1) {\n          if (pixelAt(x, y) - pixelAt(x, y - 1) >= AnchorThresh && pixelAt(x, y) - pixelAt(x, y + 1) >= AnchorThresh)\n            AnchorData.push(255, 255, 255, 255)\n          else\n            AnchorData.push(0, 0, 0, 255)\n        } else {\n          if (pixelAt(x, y) - pixelAt(x - 1, y) >= AnchorThresh && pixelAt(x, y) - pixelAt(x + 1, y) >= AnchorThresh)\n            AnchorData.push(255, 255, 255, 255)\n          else\n            AnchorData.push(0, 0, 0, 255)\n        }\n      }\n\n    }\n  }\n\n  return new Uint8ClampedArray(AnchorData)\n}\n\n// 阈值处理\n// 低于lowThresh的设置为0\nexport const threshold = function (data, lowThresh) {\n  for (let i = 0; i < data.length; i+=4) {\n    if (data[i] <= lowThresh)\n      {\n        data[i] = 0;\n        data[i+1] = 0;\n        data[i + 2] = 0;\n      }\n  }\n  return data\n}","import { cvtColorToGray, gaussianBlur, sobel, anchor, threshold } from './util'\n\n/**\n *\n * lowPoly风格图片生成器\n * \n * 接受一个类canvas ImageData对象，需要包含以下属性\n * {data:Array|Uint8ClampedArray,width:Number,height:Number}\n * 返回一个能被canvas ImageData对象\n * \n * @param {Object} imageData\n * @return {Object} \n * \n */\n\n\nfunction LowPolyGenerator(imageData) {\n\n  // 获取宽高\n  var width = imageData.width, height = imageData.height\n  // 获取图像数组 {Uint8ClampedArray|Array}\n  var imageArray = imageData.data\n\n  // 将图像转为灰度图\n  cvtColorToGray(imageArray)\n\n  // 高斯模糊\n  gaussianBlur(imageArray,width, height,2,1)\n\n  // 求图像梯度和边缘方向矩阵\n  var sobelResult = sobel(imageArray, width, height)\n\n  //阈值处理\n  threshold(sobelResult.gradientMap, 30, 140)\n\n  var anchorResult = anchor(sobelResult.gradientMap, sobelResult.directionMap, width, height, 26)\n\n  return toImageData(anchorResult,width,height)\n}\n\n\nfunction toImageData(data, width, height) {\n\n  if (typeof ImageData === 'function' && Object.prototype.toString.call(data) === '[object Uint16Array]') {\n    return new ImageData(data, width, height);\n  } else {\n    if (typeof window === 'object' && typeof window.document === 'object') {\n      var canvas = document.createElement('canvas');\n\n      if (typeof canvas.getContext === 'function') {\n        var context = canvas.getContext('2d');\n        var imageData = context.createImageData(width, height);\n        imageData.data.set(data);\n        return imageData;\n      } else {\n        return new this.fakeImageData(data, width, height);\n      }\n    } else {\n      return new this.fakeImageData(data, width, height);\n    }\n  }\n}\n\nfunction fakeImageData(data, width, height) {\n  return {\n    width: width,\n    height: height,\n    data: data\n  }\n}\n\n\nwindow.LowPolyGenerator = LowPolyGenerator\n\n"],"names":["cvtColorToGray","data","i","length","grayscale","gaussianBlur","pixes","width","height","radius","sigma","gaussMatrix","gaussSum","x","y","r","g","b","a","j","k","len","Math","floor","sqrt","PI","exp","bindPixelAt","sobel","imageData","kernelX","kernelY","sobelData","grayscaleData","directionMap","pixelAt","directionHorizontalMap","pixelX","pixelY","magnitude","push","abs","clampedArray","Uint8ClampedArray","anchor","gradientMap","AnchorThresh","AnchorData","threshold","lowThresh","LowPolyGenerator","imageArray","sobelResult","anchorResult","toImageData","ImageData","Object","prototype","toString","call","window","document","canvas","createElement","getContext","context","createImageData","set","fakeImageData"],"mappings":"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"}